{% extends "base.twig" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50 dark:bg-gray-900">
    {% include 'components/header.twig' %}
    <main class="max-w-container mx-auto px-8 py-12 relative">
        {# Decorative Circle - Bottom Left #}
        <div class="absolute bottom-0 left-0 w-48 h-48 -ml-24 -mb-24 opacity-10">
            <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                <circle cx="100" cy="100" r="80" fill="#4F46E5"/>
                <circle cx="100" cy="100" r="60" fill="#6366F1"/>
                <circle cx="100" cy="100" r="40" fill="#818CF8"/>
            </svg>
        </div>

        <div class="mb-8">
            <h1 class="text-4xl font-bold text-gray-800 dark:text-gray-100 mb-2">Dashboard</h1>
            <p class="text-gray-500 dark:text-gray-400">Welcome, <span id="user-name"></span>! Overview of your ticket management system</p>
        </div>
        <div id="skeleton-cards-wrapper" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
            {% for i in 1..4 %}
                {% include 'components/skeleton_card.twig' %}
            {% endfor %}
        </div>
        <div id="stats-cards-wrapper" class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm hover:shadow-lg transition duration-300 hover:-translate-y-1">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-primary rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 576 512"><path d="M128 160h320v192H128zm400 96c0 26.51 21.49 48 48 48v96c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48v-96c26.51 0 48-21.49 48-48s-21.49-48-48-48v-96c0-26.51 21.49-48 48-48h480c26.51 0 48 21.49 48 48v96c-26.51 0-48 21.49-48 48m-48-104c0-13.255-10.745-24-24-24H120c-13.255 0-24 10.745-24 24v208c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24z" /></svg>
                    </div>
                </div>
                <h3 class="text-gray-600 dark:text-gray-300 text-sm font-medium mb-1">Total Tickets</h3>
                <p class="text-3xl font-bold text-primary dark:text-indigo-400">{{ stats.total }}</p>
            </div>
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm hover:shadow-lg transition duration-300 hover:-translate-y-1">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-status-open rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M2.25 5.25c0-.966.784-1.75 1.75-1.75h15a1.75 1.75 0 011.75 1.75v13.5a1.75 1.75 0 01-1.75 1.75h-15a1.75 1.75 0 01-1.75-1.75V5.25zm18.56 1.28a.75.75 0 00-1.06-1.06L12 12.94 4.53 5.47a.75.75 0 00-1.06 1.06l7.5 7.5a.75.75 0 001.06 0l7.5-7.5z" clip-rule="evenodd" /></svg>
                    </div>
                </div>
                <h3 class="text-gray-600 dark:text-gray-300 text-sm font-medium mb-1">Open Tickets</h3>
                <p class="text-3xl font-bold text-status-open">{{ stats.open }}</p>
                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">{{ stats.openPercentage }}% of total</p>
            </div>
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm hover:shadow-lg transition duration-300 hover:-translate-y-1">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-status-progress rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zM12.75 6a.75.75 0 00-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 000-1.5h-3.75V6z" clip-rule="evenodd" /></svg>
                    </div>
                </div>
                <h3 class="text-gray-600 dark:text-gray-300 text-sm font-medium mb-1">In Progress</h3>
                <p class="text-3xl font-bold text-status-progress">{{ stats.inProgress }}</p>
                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">{{ stats.inProgressPercentage }}% of total</p>
            </div>
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm hover:shadow-lg transition duration-300 hover:-translate-y-1">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-status-closed rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8.603 3.799A4.49 4.49 0 0112 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 013.498 1.307 4.491 4.491 0 011.307 3.497A4.49 4.49 0 0121.75 12c0 1.357-.6 2.573-1.549 3.397a4.49 4.49 0 01-1.307 3.498 4.491 4.491 0 01-3.497 1.307A4.49 4.49 0 0112 21.75a4.49 4.49 0 01-3.397-1.549 4.49 4.49 0 01-3.498-1.306 4.491 4.491 0 01-1.307-3.498A4.49 4.49 0 012.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 011.307-3.497 4.491 4.491 0 013.497-1.307zm7.007 6.387a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" /></svg>
                    </div>
                </div>
                <h3 class="text-gray-600 dark:text-gray-300 text-sm font-medium mb-1">Resolved Tickets</h3>
                <p class="text-3xl font-bold text-status-closed">{{ stats.closed }}</p>
                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">{{ stats.closedPercentage }}% of total</p>
            </div>
        </div>
        <div class="bg-gradient-to-br from-primary to-primary-light text-white p-8 rounded-xl shadow-xl">
            <h2 class="text-2xl font-bold mb-4">Quick Actions</h2>
            <p class="mb-6 text-indigo-100">Manage your tickets efficiently with our comprehensive tools</p>
            <div class="flex flex-col sm:flex-row gap-4">
                <a href="/tickets" class="bg-white text-primary px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition text-center focus:outline-none focus:ring-4 focus:ring-white focus:ring-opacity-50">View All Tickets</a>
                <a href="/tickets?action=create" class="bg-transparent border-2 border-white text-white px-6 py-3 rounded-lg font-semibold hover:bg-white hover:text-primary transition text-center focus:outline-none focus:ring-4 focus:ring-white focus:ring-opacity-50">Create New Ticket</a>
            </div>
        </div>
    </main>
    {% include 'footer.twig' %}
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const user = getCurrentUser();
    if (user) {
        document.getElementById('user-name').textContent = user.name;
    }

    const logoutButton = document.getElementById('logout-button');
    if (logoutButton) {
        logoutButton.addEventListener('click', function(event) {
            event.preventDefault();
            logout();
        });
    }

    const skeletonWrapper = document.getElementById('skeleton-cards-wrapper');
    const statsWrapper = document.getElementById('stats-cards-wrapper');
    if (skeletonWrapper && statsWrapper) {
        setTimeout(function() {
            skeletonWrapper.classList.add('hidden');
            statsWrapper.classList.remove('hidden');
        }, 700);
    }
});
</script>
{% endblock %}
